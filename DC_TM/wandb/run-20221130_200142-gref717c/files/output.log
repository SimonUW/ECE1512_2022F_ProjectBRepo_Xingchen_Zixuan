
 16%|████████████▏                                                              | 8109/50000 [00:01<00:07, 5251.49it/s]
Hyper-parameters:
 {'dataset': 'CIFAR10', 'subset': 'imagenette', 'model': 'ConvNet', 'lr_img': 1000, 'lr_lr': 1e-05, 'lr_teacher': 0.01, 'lr_init': 0.01, 'batch_real': 256, 'batch_train': 256, 'batch_syn': 100, 'pix_init': 'real', 'dsa': False, 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': 'CIFAR10data', 'buffer_path': './CIFAR10buffers', 'expert_epochs': 3, 'syn_steps': 20, 'max_start_epoch': 20, 'load_all': False, 'no_aug': False, 'zca': False, 'texture': False, 'canvas_size': 2, 'canvas_samples': 1, 'max_files': None, 'max_experts': None, 'force_save': False, 'ipc': 10, 'eval_mode': 'S', 'num_eval': 5, 'eval_it': 100, 'epoch_eval_train': 1000, 'Iteration': 1000, 'device': 'cuda', 'im_size': [32, 32], 'dc_aug_param': None, 'dsa_param': <utils.ParamDiffAug object at 0x000002624D115690>, '_wandb': {}, 'zca_trans': None, 'distributed': False}



100%|██████████████████████████████████████████████████████████████████████████| 50000/50000 [00:09<00:00, 5426.27it/s]
50000it [00:00, 3163077.48it/s]
C:\Users\zixua\AppData\Local\Temp\ipykernel_18916\379095684.py:107: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at C:\cb\pytorch_1000000000000\work\torch\csrc\utils\tensor_new.cpp:233.)
  label_syn = torch.tensor([np.ones(args.ipc,dtype=np.int_)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random real images
[2022-11-30 20:01:52] training begins
Expert Dir: ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
  0%|▎                                                                                | 4/1001 [00:00<01:00, 16.60it/s]
[2022-11-30 20:01:56] iter = 0000, loss = 1.1140
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0





























100%|█████████████████████████████████████████████████████████████████████████████▉| 1000/1001 [00:56<00:00, 16.61it/s]
[2022-11-30 20:02:58] Evaluate: epoch = 1000 train time = 62 s train loss = 0.000918 train acc = 1.0000, test acc = 0.2484

100%|██████████████████████████████████████████████████████████████████████████████| 1001/1001 [01:02<00:00, 16.12it/s]
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
[2022-11-30 20:03:06] iter = 0010, loss = 0.9634
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
[2022-11-30 20:03:13] iter = 0020, loss = 0.9592
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
[2022-11-30 20:03:20] iter = 0030, loss = 0.9263
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
[2022-11-30 20:03:27] iter = 0040, loss = 0.9785
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
[2022-11-30 20:03:34] iter = 0050, loss = 0.9000
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
[2022-11-30 20:03:41] iter = 0060, loss = 0.9638
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
[2022-11-30 20:03:48] iter = 0070, loss = 0.9836
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
[2022-11-30 20:03:55] iter = 0080, loss = 0.9816
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
[2022-11-30 20:04:01] iter = 0090, loss = 0.9121
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
[2022-11-30 20:04:08] iter = 0100, loss = 0.9785
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 100
==================== Final Results ====================































100%|█████████████████████████████████████████████████████████████████████████████▉| 1000/1001 [01:02<00:00, 14.00it/s]
[2022-11-30 20:05:16] Evaluate: epoch = 1000 train time = 67 s train loss = 0.001026 train acc = 1.0000, test acc = 0.2509

100%|██████████████████████████████████████████████████████████████████████████████| 1001/1001 [01:07<00:00, 14.90it/s]
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_0.pt
[2022-11-30 20:05:23] iter = 0110, loss = 0.9829
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
loading file ./CIFAR10buffers\CIFAR10_NO_ZCA\ConvNet\replay_buffer_1.pt
[2022-11-30 20:05:30] iter = 0120, loss = 0.9071
